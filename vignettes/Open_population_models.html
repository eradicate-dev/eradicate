<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Models for assessing eradication progress for open populations</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Models for assessing eradication progress
for open populations</h1>



<div id="dave-ramsey-27052022" class="section level3">
<h3>Dave Ramsey (27/05/2022)</h3>
<p>Often eradication programs are implemented for populations over a
period of time where it would be unreasonable to assume population
‘closure’. By closure, we mean that the population is demographically
closed and hence, there are no births, deaths, immigration or
emmigration. Typically, standard removal type models assume demographic
closure and hence, the only changes to the population occur from
eradication (control) activities. This is reasonable if eradication is
undertaken over a fairly short period of time (i.e. within a breeding
season). However, often eradication activities are undertaken over a
longer period (i.e. several years or breeding seasons) and it may be
unreasonable to assume that the the population does not change between
bouts of control. In this case, we need to apply more sophisticated
models to our removal data to account for the extent of potential
population changes due to births, natural mortality or immigration that
may be occurring during the eradication phase.</p>
<p>Here we illustrate the use of ‘open population models’ in the
<code>eradicate</code> package that can be applied to removal data to
assess eradication progress for populations that might also be subject
to demographic changes during the eradication phase. Here we assume that
eradication activities typically occur in bouts or ‘sessions’ of control
separated by periods where no control occurs. The length of time between
control sessions can vary but must be known. Control activities within a
session must be intense enough to reduce population abundance during the
session, as would typically be assumed for the equivalent closed
population removal type models. However, in between control sessions,
the population may increase or decrease through other demographic
processes. Hence, open population models attempt to estimate the extent
of these population changes between sessions. The most simple open
population model considered here doesn’t attempt to estimate the
additions or losses between sessions, but accounts for the extent of
these changes by fitting parameters for each session. More complex
models are undertaken by fitting a simple model for the dynamics of the
population to the removal data. These models typically have parameters
for the rate of population change due to
births/deaths/immigration/emmigration that could occur between each bout
of control activities.</p>
<p>We illustrate these models using an example of the eradication of a
hypothetical population of rabbits from San Nicolas Island, California.
In this example, rabbits were removed over the course of two years (or
two breeding seasons) using trapping. Hence, during the eradication
program, the population was also changing due to natural demographic
processes of births and natural mortality. There was also the
possibility that rabbits could potentially move between trapping
locations.</p>
<p>Since this is a simulated dataset, we know exactly what the
population size was before the eradication program began (1791 rabbits).
Before we start we load various the packages necessary for our analysis
…</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eradicate)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div>
<p>… and then read in the shapefile of the region and a raster of
habitat values. The raster has a resolution (cell size) of 100 m
indicating the presence of grassland or forest.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>region<span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;shape/san_nic_region.shp&quot;</span>, <span class="at">package=</span><span class="st">&quot;eradicate&quot;</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>habitat<span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;san_nic_habitat.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;eradicate&quot;</span>))</span></code></pre></div>
</div>
<div id="rabbit-eradication" class="section level2">
<h2>Rabbit eradication</h2>
<p>We undertake a simulated eradication of rabbits using a grid of 100
traps set across the island. Traps were set a minimum of 500m apart,
which was thought to be similar to the home range diameter of rabbits on
the island. Simulated trapping was undertaken every three months over
four nights at each trapping location. A total of eight trapping
sessions were undertaken over a two year period. Trap locations and
associated removal data are located in the example dataset
<code>san_nic_open</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>traps<span class="ot">&lt;-</span> san_nic_open<span class="sc">$</span>traps</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span> san_nic_open<span class="sc">$</span>removals</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(y)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 9</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   session    r1    r2    r3    r4    r5    r6    r7    r8</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1     3     0     2     0     0     2     0     0</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       1     0     1     1     1     1     2     1     1</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       1     1     0     1     0     1     0     1     0</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       1     2     1     1     1     0     0     0     1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       1     1     0     2     1     0     0     0     0</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       1     1     2     2     2     0     1     1     0</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(habitat, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(region), <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(traps, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The removal data <code>y</code> are organised in a ‘stacked’ data
frame with sites x sessions in rows and removals for each secondary
period in columns. The first column must be labelled
<code>session</code> and contain a numeric session number for each
observation. The remaining columns contain the removal data for each of
the removal (secondary) periods for each trap location. Each session
<em>must</em> have the same number of rows so the total number of rows
should be <code>T</code> x <code>M</code> where <code>T</code> is the
number of sessions and <code>M</code> is the number of sites (trap
locations). Rows where traps were missing or out of action for a
particular session should be <code>NA</code> (missing). Since our data
consisted of trapping from 8 sessions with a total of 100 traps the
total number of rows is 800.</p>
<p>Since rabbits prefer grassland over forest, we extract that
information for each trap from <code>habitat</code> for use in further
modelling. Cells in the habitat raster took values of either 1
(grassland) or 0 (forest). Rather than just extract the habitat value
from the focal cell containing each trap location, we get the average of
all cells within 500 m of the focal cell.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>traps_sf<span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(traps, <span class="at">coords=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">crs=</span><span class="fu">st_crs</span>(region))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>traps_buff<span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(traps_sf, <span class="at">dist=</span><span class="dv">500</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pgrass<span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(habitat, <span class="fu">vect</span>(traps_buff), <span class="at">fun=</span>mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pgrass)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>,<span class="st">&quot;pgrass&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>site.data<span class="ot">&lt;-</span> <span class="fu">cbind</span>(pgrass, traps)</span></code></pre></div>
<p>We are now ready to fit some models! The first step in the analysis
is to collate the removal data and the associated covariate information
(i.e. habitat) into a custom data class using <code>eFrameMNS()</code>.
See <code>?eFrameMNS</code> for more info on organizing the data
necessary to use the models in <code>eradicate</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>emf<span class="ot">&lt;-</span> <span class="fu">eFrameMNS</span>(y, <span class="at">siteCovs =</span> site.data)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(emf)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; eFrameMNS Object</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 100  removal sites</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of primary periods: 5 </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum number of secondary periods: 8 </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of removals per session: </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Session Removed</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1    1311</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       2     463</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       3     217</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       4      68</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       5      34</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total removed: 2093 </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sites with at least one detection: 100 </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tabulation of y observations:</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0    1    2    3    4    5    6    7    8    9   10 </span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2888  616  259  117   57   30   15   11    3    1    3 </span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 100 Additional monitoring sites</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tabulation of additional monitoring observations:&lt; table of extent 0 &gt;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Site-level covariates:</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        id             pgrass             x                 y         </span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :  1.00   Min.   :0.0000   Min.   :1853114   Min.   :469872  </span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 25.75   1st Qu.:0.2644   1st Qu.:1856651   1st Qu.:471971  </span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 50.50   Median :0.6241   Median :1859026   Median :473202  </span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 50.50   Mean   :0.5377   Mean   :1859236   Mean   :473313  </span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 75.25   3rd Qu.:0.7957   3rd Qu.:1861813   3rd Qu.:474932  </span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :100.00   Max.   :1.0000   Max.   :1866030   Max.   :476950</span></span></code></pre></div>
<p>The analysis of removal data from open populations is accomplished
with the function <code>remMNS()</code> (short for removal MultiNomial
Stacked). This model conducts an analysis of the removal data for each
session by fitting a factor <code>.season</code> to the model for the
abundance component, which results in a separate abundance parameter for
each session, in addition to any other covariates. Alternatively, we can
assume a linear trend for the (log) abundances by including the term
<code>.trend</code> in the abundance component. This might be useful if
there are insufficient data for a particular session causing the model
to fail. The model also allows the detection component to be estimated
separately for each season or alternatively, a trend or constant
detection probability can be assumed for each session. A trend or
constant detection probability is probably more likely to result in
reasonable estimates when data for any particular session is sparse. We
begin by fitting some models for the abundance component dependent on
the covariate <code>pgrass</code> for the proportion of grassland at the
site with either separate estimates for each session or a trend and
include a constant or trend in detection probability among sessions. We
compare models using AIC.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">remMNS</span>(<span class="sc">~</span>pgrass <span class="sc">+</span> .season, <span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>emf)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">remMNS</span>(<span class="sc">~</span>pgrass <span class="sc">+</span> .season, <span class="sc">~</span>.trend, <span class="at">data=</span>emf)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">remMNS</span>(<span class="sc">~</span>pgrass <span class="sc">+</span> .trend, <span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>emf)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">remMNS</span>(<span class="sc">~</span>pgrass <span class="sc">+</span> .trend, <span class="sc">~</span>.trend, <span class="at">data=</span>emf)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit1)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5513.067</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit2)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5514.936</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit3)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5514.337</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit4)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5516.217</span></span></code></pre></div>
<p>The model AICs indicates that there is not much between these models
which suggests that the model with the fewest parameters might be a
sufficient. Hence model 1 or 3 with season or trend in abundance and
constant detection might be preferred. We take summaries of both</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Abundance (log-scale):</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z   P(&gt;|z|)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     1.58 0.0713  22.2 3.32e-109</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pgrass          2.03 0.0837  24.2 8.76e-130</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season2       -1.04 0.0541 -19.3  1.34e-82</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season3       -1.80 0.0733 -24.5 5.22e-133</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season4       -2.96 0.1244 -23.8 4.08e-125</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season5       -3.65 0.1737 -21.0  3.89e-98</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Detection (logit-scale):</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z   P(&gt;|z|)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -1.68 0.0635 -26.4 7.57e-154</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Abundance (log-scale):</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z   P(&gt;|z|)</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    2.513 0.0793  31.7 1.87e-220</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pgrass         2.029 0.0837  24.2 8.76e-130</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .trend        -0.945 0.0242 -39.0  0.00e+00</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Detection (logit-scale):</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z   P(&gt;|z|)</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -1.68 0.0635 -26.4 7.56e-154</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>This indicates that parameters for both models are highly
significant. The parameter for the effect of <code>pgrass</code> on
abundance indicates that rabbit abundance is around 5 times higher on
grassland than forest habitat. The estimate of detection probability was
0.157 for model 1 and 0.157 for model 3 per sampling occasion. Assuming
that each trapping location is independent, we can get an estimates of
the population size for both models using <code>calcN()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ests1<span class="ot">&lt;-</span> <span class="fu">calcN</span>(fit1)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Initial population size</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ests1<span class="sc">$</span>Nhat</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      N .season   se  lcl  ucl</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1758       1 68.2 1629 1897</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  621       2 33.5  559  690</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  291       3 21.3  252  336</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   91       4 11.3   72  116</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   46       5  7.9   33   64</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>ests3<span class="ot">&lt;-</span> <span class="fu">calcN</span>(fit3)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ests3<span class="sc">$</span>Nhat</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      N .season   se  lcl  ucl</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1731       1 65.4 1608 1864</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  673       2 24.4  627  723</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  262       3 12.8  238  288</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  102       4  6.9   89  116</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   40       5  3.5   33   47</span></span></code></pre></div>
<p>Which indicates that the estimate for the initial number of rabbits
for model 1 was 1758 and for model 2 was 1731. The actual number of
rabbits on the island was 1791 so estimates from both models are
reasonable. We can also get an estimate of the residual number of
rabbits following the final removal period</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual population size</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ests1<span class="sc">$</span>Nresid</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           N  se lcl ucl</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 12 7.9   3  39</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ests3<span class="sc">$</span>Nresid</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          N  se lcl ucl</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 6 3.5   2  17</span></span></code></pre></div>
<p>which indicates there are likely around 12 or 6 rabbits remaining on
the island with the lower confidence bound indicating a minimum of at
least one rabbit.</p>
</div>
<div id="including-additional-index-data" class="section level2">
<h2>Including additional index data</h2>
<p>In some instances, an alternative monitoring method may also be
employed in addition to the removal method. Monitoring of this sort is
not designed to remove individuals but is used instead as an ‘index’ of
abundance. Such index data may be useful in situations where the removal
method is no longer detecting individuals and may provide evidence that
individuals are avoiding the removal method. If index monitoring is
employed at the same general locations as the removals then we can
jointly analyse both the removal data and the index data to infer
population abundance. As we are now analysing two monitoring methods
simultaneously, we might expect the resulting population estimate to be
more precise than when only a single monitoring method is analysed.</p>
<p>For our rabbit eradication, managers also deployed camera traps in
the same general locations as the traps to generate an index of rabbit
abundance. In general, any monitoring data that we might use to generate
a population index would be suitable to use as the index data, as long
as we can assume that it is linearly related to abundance. We load the
camera index data here</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>idx<span class="ot">&lt;-</span> san_nic_open<span class="sc">$</span>index</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(idx)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 9</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   session    i1    i2    i3    i4    i5    i6    i7    i8</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1     1     1     1     0     0     1     1     0</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       1     3     2     4     6     0     2     1     2</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       1     0     1     1     1     3     0     0     0</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       1     0     2     0     2     1     0     0     2</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       1     3     3     1     2     0     0     0     0</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       1     4     2     1     2     0     1     0     0</span></span></code></pre></div>
<p>Note that the index data has the same dimensions as the removal data
analysed earlier. If some removal locations do not have associated index
data then the corresponding entries should be left blank and will be
treated as missing values.</p>
<p>Joint analysis of both the removal and index data for open
populations with multiple primary sessions is accomplished with the
model <code>remGRMS()</code>. We analyse both removal and index data
using a similar model that was used for the removal only analysis.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>emf<span class="ot">&lt;-</span> <span class="fu">eFrameGRMS</span>(y, idx, <span class="at">siteCovs =</span> site.data)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">&lt;-</span> <span class="fu">remGRMS</span>(<span class="sc">~</span>pgrass <span class="sc">+</span> .season, <span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>emf)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Abundance (log-scale):</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z   P(&gt;|z|)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    1.636 0.0482  33.9 2.60e-252</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pgrass         1.987 0.0576  34.5 1.40e-260</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season2      -0.998 0.0369 -27.0 1.11e-160</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season3      -1.804 0.0508 -35.5 8.36e-276</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season4      -2.912 0.0841 -34.6 7.47e-263</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season5      -3.726 0.1235 -30.2 9.02e-200</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Detection (logit-scale):</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z   P(&gt;|z|)</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -1.72 0.0521 -33.1 1.38e-240</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mDetection (log-scale):</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z P(&gt;|z|)</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -1.47 0.0334 -43.9       0</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>Of note is that the formula now contains an extra term compared with
the <code>remMNS</code> model. This is to model the detection
probability of the index data, given here as <code>mDetection</code>.
Here we just assume constant detection for this term. The estimates of
abundance for each session are again calculated from the fitted model
using <code>calcN</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ests<span class="ot">&lt;-</span> <span class="fu">calcN</span>(mod)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>ests<span class="sc">$</span>Nhat</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      N .season   se  lcl  ucl</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1798       1 46.3 1710 1891</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  663       2 23.6  618  711</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  296       3 14.7  269  326</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   98       4  8.2   83  115</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   43       5  5.3   34   55</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>ests<span class="sc">$</span>Nresid</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          N  se lcl ucl</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 9 5.3   3  26</span></span></code></pre></div>
<p>This gives an estimate quite close to the true abundance of 1791.
Also note that the abundance estimates for each session have lower
standard errors compared with the removal only model.</p>
</div>
<div id="dynamic-occupancy-models" class="section level2">
<h2>Dynamic Occupancy Models</h2>
<p>A second type of open population model can be used for
presence/absence data to estimate ‘occupancy’ (probability of
occurrence). This is a more complex model than the ‘stacked’ model
considered earlier as it attempts to model the survival and recruitment
process, in addition to the state process (occupancy), all while
accounting for imperfect detection. Here we analyse the same rabbit
dataset as above using the dynamic occupancy model of McKenzie et
al. (2003). This model has parameters for the rate of colonisation of
un-occupied sites between sessions (<code>gamma</code>) as well as the
extinction rate of occupied sites between sessions
(<code>epsilon</code>). This model can be fitted using the
<code>occMS</code> function in the <code>eradicate</code> package. We
fit a simple dynamic occupancy model to the rabbit dataset that only
considers the effect of <code>pgrass</code> on the occupancy
probability, with constant parameters for the colonisation, extinction
and detection rates. We also fit some alternatives that include separate
estimates of the colonisation and extinction rates for each session and
compare models with AIC. Note that we can use the same count data used
previously as <code>occMS</code> will truncate the counts to 0/1 and
give a warning.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>emf <span class="ot">&lt;-</span> <span class="fu">eFrameMS</span>(y, <span class="at">siteCovs=</span>site.data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in truncateToBinary(y): Some observations were &gt; 1. These were truncated</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; to 1.</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># order of terms is lamformula (occupancy), gamformula (colonisation), epsformula (extinction)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and detformula (detection)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>occ1 <span class="ot">&lt;-</span> <span class="fu">occMS</span>(<span class="sc">~</span>pgrass, <span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>, emf)  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>occ2 <span class="ot">&lt;-</span> <span class="fu">occMS</span>(<span class="sc">~</span>pgrass, <span class="sc">~</span>.season, <span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>, emf)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>occ3 <span class="ot">&lt;-</span> <span class="fu">occMS</span>(<span class="sc">~</span>pgrass, <span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span>.season, <span class="sc">~</span><span class="dv">1</span>, emf)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>occ4 <span class="ot">&lt;-</span> <span class="fu">occMS</span>(<span class="sc">~</span>pgrass, <span class="sc">~</span>.season, <span class="sc">~</span>.season, <span class="sc">~</span><span class="dv">1</span>, emf)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(occ1)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3893.981</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(occ2)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3890.386</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(occ3)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3851.868</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(occ4)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3850.688</span></span></code></pre></div>
<p>Analysis has revealed that model 4, including colonisation and
extinction parameters varying by session was the most supported model,
based on AIC. we can get parameter estimates with
<code>summary()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(occ4)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Initial (logit-scale):</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z P(&gt;|z|)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     2.31   1.15 2.001  0.0454</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pgrass         57.90 128.97 0.449  0.6535</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Colonization (logit-scale):</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate   SE      z P(&gt;|z|)</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     7.68 45.4  0.169   0.866</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season2       -8.18 45.4 -0.180   0.857</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season3       -9.52 45.4 -0.210   0.834</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season4      -10.16 45.4 -0.224   0.823</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Extinction (logit-scale):</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate    SE     z  P(&gt;|z|)</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -2.28 0.364 -6.27 3.66e-10</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season2        1.51 0.431  3.50 4.67e-04</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season3        2.29 0.442  5.18 2.22e-07</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season4        2.54 0.494  5.13 2.92e-07</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Detection (logit-scale):</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z  P(&gt;|z|)</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -0.231 0.0411 -5.63 1.81e-08</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>The parameter estimates for this model do show that there was some
issues with the fit with estimates for the colonisation rate for session
6 having very large standard errors. None of the other colonisation
parameters appear significant, based on the Wald tests. Hence, despite
having the lowest AIC, it may be prudent to consider a simpler model,
such as model 3, with constant colonisation rate. A model summary for
this model shows no issues.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(occ3)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Initial (logit-scale):</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate   SE      z P(&gt;|z|)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     8.56 26.2 0.3268   0.744</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pgrass          2.61 50.5 0.0516   0.959</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Colonization (logit-scale):</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate   SE     z  P(&gt;|z|)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -2.05 0.33 -6.21 5.46e-10</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Extinction (logit-scale):</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate    SE     z  P(&gt;|z|)</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -2.42 0.401 -6.04 1.59e-09</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season2        1.62 0.458  3.53 4.10e-04</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season3        2.43 0.472  5.14 2.69e-07</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .season4        2.67 0.521  5.13 2.94e-07</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Detection (logit-scale):</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate     SE     z  P(&gt;|z|)</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -0.242 0.0413 -5.87 4.33e-09</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>We can now get estimates of the occupancy probability for model 3 for
each season using <code>calcN</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ests<span class="ot">&lt;-</span> <span class="fu">calcN</span>(occ3)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>ests<span class="sc">$</span>Nhat</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      N   se  lcl  ucl .season</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1.00 0.00 1.00 1.00       1</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.91 0.01 0.90 0.93       2</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.66 0.01 0.65 0.67       3</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.37 0.01 0.37 0.39       4</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0.21 0.00 0.21 0.23       5</span></span></code></pre></div>
<p>The estimates of the occupancy probability for model 3 indicate high,
almost perfect occupancy initially, declining to 0.21 by the final
session. As the lower confidence bound is greater than zero, we can
conclude that rabbits still remain on the island.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
